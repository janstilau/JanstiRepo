# 程序设计实践

## Style

代码应该是清楚的和简单的—具有直截了当的逻辑、自然的表达式、通行的语言使用方式, 有意义的名字和有帮助作用的注释等，应该避免耍小聪明的花招，不使用非正规的结构。一致性是非常重要的东西，如果大家都坚持同样的风格，其他人就会发现你的代码很容易读，你也容易读懂其他人的。风格的细节可以通过一些局部规定，或管理性的公告，或者通过程序来处理。如果没有这类东西，那么最好就是遵循大众广泛采纳的规矩。

### 名字

一个变量或函数的名字标识这个对象，带着说明其用途的一些信息。
一个变量的作用域越大，它的名字所携带的信息就应该越多。
全局变量使用具有说明性的名字，局部变量用短名字。
全局变量可以出现在整个程序中的任何地方，因此它们的名字应该足够长，具有足够的说明性，以便使读者能够记得 它们是干什么用的。
人们常常鼓励程序员使用长的变量名，而不管用在什么地方。这种认识完全是错误的，清晰性经常是随着简洁而来的。

与始终如一地坚持一种切合实际的约定相比, 那些特殊的规则并不太重要.

在可以通过上下文推断命名含义的时候, 不应该在增加这个上下文的信息在名称里面, 例如, 一个 queue 这样的一个类. queueCapacity 就很愚蠢. 在使用的时候, 就是 Queue queue, queue.queueCapacity. bad smell.

动作性的函数, 应该是动词 + 名词的形式.
Bool返回值的函数, 应该用明确的 is, has, did 这种表示疑问的词, 而不应该是 checkSth. 这更像是一个动作, 这个动作其中会发生什么事情, 但不一定会返回一个 bool 值.

### 表达式和语句

和代码技巧和清晰性相比, 代码技巧不重要. 除非这种技巧是约定俗成大家都已经接受的规范.
含有否定运算的条件表达式难以理解, 最好能够变成肯定形式.
加括号的方式可以消除二义性. 有的时候, 即使不重要, 加了括号也能把意图表达的更加清楚. 运算符优先级是个, 容易犯错误的地方.
运算符左右加空格, 但有的时候, 使运算符和运算对象连在一起, 能够帮助读者更快的看清表达式, 比如多个条件表达式相连的情况.
程序员有时把自己无穷尽的创造力用到了写最简短的代码上，或者用在寻求得到结 果的最巧妙方法上。有时这种技能是用错了地方，因为我们的目标应该是写出最清晰的代码， 而不是最巧妙的代码。
有些结构似乎总是要引诱人们去滥用它们。运算符 ? : 大概属于这一类.
这个运算符适用于短的表达式,  max = (a >  b) ? a: b, 但是不能用作条件语句的一般性的替换.
评判一个代码的可读性, 易于理解是最重要的标准. 短的代码一般易于理解, 但是如果是为了短小导致不利于理解, 本末倒置.

副作用. ++. 除非明确的是想要这些副作用, 否则不要使用. 有些函数就有副作用, 但是从命名上看, 仅仅是一个查询函数. 但是很多官方代码就是这样的, 比如懒加载就是这样的一个体现.

### 一致性和习惯用法.

如果程序中, 相同的计算每次都使用了同样的方法, 那么任何的变化都表明, 这里是经过了生死熟虑, 需要读程序的人注意.
特定的风格, 远远没有一致性使用它们重要, 不要在这里浪费时间.
逻辑判断复杂的代码段, 可以通过引用临时变量的方式, 避免过多的缩进嵌套. 如果工作在一个不是自己写的程序上面, 应该注意保持程序原有的风格. 程序的一致性, 比的本人的习惯更加重要.
要熟悉一个语言的习惯用法.
do while 循环, 永远比 for, while 循环用的少. 首先, 它必须执行一次操作, 第二, 他是在末尾而不是开头进行可行性判断, 这很多情况下亲戚问题.
一段嵌套的 if 语句, 通常是一段粗劣的代码啊.

### 函数宏

函数宏有很多缺点, 现在已经没有使用的意义了.
最常见的问题, 如果一个参数在定义中出现了多次, 那么每一次都要被求值.
宏是通过替换文本的方式实现的. 所以如果传进给宏的是一个表达式, 而表达式被展开, 可能会引起问题. 为了避免这个问题, 要在宏外层加很多的括号. 除了逻辑复杂之外, 还是没有解决上面多次计算的问题. 如果这些计算有副作用, 那么很有可能不是你想要的结果.

### magic word

常熟, 大小量, 特定位置, 特殊标记符号, 文本. 这些都是和程序逻辑无关的数值.

* 起个名字
一个原本形式的数, 对于本身的重要性或作用, 没有任何指示性的信息, 这会导致程序的难以理解和修改.
* 把数定义为常熟, 而不是宏.
* 为类型设置初值的时候, 不要过多的使用0, 而是每种类型特定的 0 的表示. NULL, '\0', 0.0f. 0 只是应该用作整数常量.
* 多用 sizeof, 而不是自己记忆中的数字. 或者说, 多用函数取得相关的值, 而不是自己的实现. 例如, 一个 view 的子 view 根据父 view 进行布局, 虽然我们知道父 view 现在一定是和屏幕一样的宽高, 但是在代码中, 不能出现屏幕宽作为布局的依据, 而是父 view 的 width 作为依据. 因为, 现在的代码就有点问题, 因为布局计算的时候用的是一个常量, 而这个常量是当初编写代码的时候脑子中记住的一个量, 导致现在想要复用这个值需要修改之前的源代码.

### 注释

* 注释不要去谈明白的东西, 代码本身就应该具有可读性. 那些不能从代码中一眼看出来的东西, 或者零散在信息中不好看透的东西, 可以通过注释澄清.
* 为全局数据添加注释.
* 不要注释差的代码, 重写它.
* 不要和代码矛盾. 注释最大的问题是, 代码可能会经常修改, 但是注释经常忘记修改. 这样, 注释反而是误导程序的阅读者.


### 目的

说明性的文字, 清晰的表达, 直接了当的控制流, 可读的代码和注释, 一致性的规则.

书写良好的代码, 能够更加容易的阅读和理解, 保证错误更少. 草率的代码是很坏的代码, 难看, 难度, 经常崩溃.

好的风格应该成为一种习惯.

## 算法和数据结构.

### 检索

二分查找每次工作丢掉一般的数据, 时间复杂度是 log 2n. 不过有前提就是, 必须是排序好的数据. 其实, 红黑树就是二分查找的应用.

### 排序

快速排序:

* 从数组里面取出一个元素作为比较的基准值
* 把其他的元素分为两组, 小的放到基准值的左边, 大的放到基准值的右边
* 递归排序左右两个数组

快速排序快的原因在于: 一旦知道了, 某个元素比基准值小, 它就不用在和那些比基准值还大的元素进行比较了. 而简单的排序算法, 是每个元素, 都要和其他的元素进行比较.

所以算法的意义, 其实在于, 减少某些无用的操作. 可以是通过逻辑判断, 也可以通过额外的内存空间进行存储.

### 散列表

* 原理性的东西, 和侯捷的视频一样.


## 设计和实现

程序设计语言, 在整个设计的过程中, 相对而言并不是那么重要. 程序应该是一个抽象的设计.
