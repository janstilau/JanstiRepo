# 组件协作

组件协作的一个模式.

软件现在分工, 变成了框架和应用程序两类. 组件协作, 通过晚绑定, 来实现框架和应用程序之间的松耦合.

模板方法, 策略模式, 观察者模式, 都是组件协作很相关的模式.

## 模板方法

对于某一项任务, 常常有 **稳定** 的整体操作结构, 但是各个子步骤会有 **改变** 的需求. 那么如何在稳定操作结构的前提下, 来灵活应对各个子步骤, 或者晚期出现类来实现需求呢.

这个设计模式其实用的很多, 我们写 app 应用程序, 复写的那些方法, 都是模板方法里面变化的点. 整个 app 怎么运转, 都是框架开发人员设定好的, 当屏幕被 touch 的时候, 触发 view 的 touches 方法, 这是框架的责任, 我们通过重写这个方法的实现, 将我们自己的逻辑, 添加到整个程序的运转逻辑中.

* 定义一个操作中, 算法的框架(稳定), 而将一些步骤 (变化)的实现延迟到子类中(支持子类的变化的功能), 模板方法, 使得子类可以复用一个算法的结构, 并且可以重新定义某些特定的步骤.

如果不用模板方法, 而是库暴露了一些接口给应用程序开发人员调用, 那么想要完成功能就变成了

```cpp
1. 应用程序人员调用 ku.1
1. 应用程序人员调用 自己.2
1. 应用程序人员调用 ku.3
1. 应用程序人员调用 自己.4
1. 应用程序人员调用 ku.5
```

可以看出, 这样写首先, 将算法的结构交给了应用程序开发人员实现, 这对于他们来说是负担, 更为重要的是, 这是一个稳定的结构, 不应该由开发人员自己组合而成. 再者, 调用的方向发现了改变, 这样就成了应用程序调用库了, 而模板方法则是, 库调用应用程序复写的方法.

## 缺点

模板方法假设, 算法是稳定的. 如果算法不稳定, 或者你的程序根本就没有稳定的框架, 就不应该用模板方法模式.

设计模式, 是将稳定的点 和非稳定的点进行组合, 如果没有找到稳定的点, 不要套用设计模式. 如果没有变化的点, 也不要套用设计模式. 设计模式是为了分离变化点和稳定点, 如果没有找到两个层之间的差异, 设计模式也就没有用.

应用程序的开发人员, 常常被模板方法挡在了技术点之外, 因为只是写一些子步骤, 整个程序的运转被封装在框架里面. 所以, 作为应用程序开发人员, 应该努力去理解, 框架到底是怎么运转的.